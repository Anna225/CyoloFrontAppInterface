@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    ViewData["Title"] = "Welcome " + @ViewBag.Name;
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1 class="thumb-text">@ViewData["Title"]</h1>

@using (Html.BeginForm("GetByCourtCase", "CourtCase", FormMethod.Post, new { id = "searchform" }))
{
    <div class="row">
        <div class="form-group col-md-6">
            <label for="courttype">CourtType:</label>
            @Html.DropDownList("courttype",
        new SelectList(ViewBag.CourtTypes),
        @ViewBag.CourtCase.CourtType,
        new { @class = "form-control", @id = "courttype" })
        </div>
        <div class="form-group col-md-6">
            <label for="courtlocation">CourtLocation:</label>
            @Html.DropDownList("courtlocation",
        new SelectList(ViewBag.CourtLocations),
        @ViewBag.CourtCase.CourtLocation,
        new { @class = "form-control", @id = "courtlocation" })
        </div>
    </div>
    <div class="row">
        <div class="form-group col-md-4">
            <label for="chamberid">ChamberID:</label>
            @Html.DropDownList("chamberid",
        new SelectList(ViewBag.ChamberIds),
        @ViewBag.CourtCase.ChamberID,
        new { @class = "form-control", @id = "chamberid" })
        </div>
        <div class="form-group col-md-4">
            <label for="hearingdate">HearingDate:</label>
            <div class="form-group">
                @Html.TextBox("hearingdate", (string)@ViewBag.CourtCase.HearingDate, new { @class = "form-control", @placeholder="Ex:1970-01-01" })
            </div>
        </div>
        <div class="form-group col-md-4">
            <label for="hearingtime">HearingTime:</label>
            @Html.TextBox("hearingtime", (string)@ViewBag.CourtCase.HearingTime, new { @class = "form-control", @placeholder="Ex:14:37" })
            <input type="hidden" name="courtcaseno" id="courtcaseno" value="@ViewBag.Number" />
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <a class="btn btn-success" onclick="submitForm()">Search</a>
        </div>
    </div>
}
@Html.Label("datefor", "RESULT FOR:")
<table class="table table-striped table-bordered">
    <thead>
        <tr>
            <th>Court Type</th>
            <th>Court Location</th>
            <th>Chamber ID</th>
            <th>Hearing Date</th>
            <th>Hearing Time</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>@ViewBag.CourtCase.CourtType</td>
            <td>@ViewBag.CourtCase.CourtLocation</td>
            <td>@ViewBag.CourtCase.ChamberID</td>
            <td>@ViewBag.CourtCase.HearingDate</td>
            <td>@ViewBag.CourtCase.HearingTime</td>
        </tr>
    </tbody>
</table>

<table class="table table-striped table-bordered">
    <thead>
        <tr>
            <th>No</th>
            <th>First name</th>
            <th>Last name</th>
            <th>E-mail</th>
            <th>Fixed phone number</th>
            <th>Cell phone number</th>
            <th>Preferences for receiving requests</th>
            <th>Additional comments</th>
        </tr>
    </thead>
    <tbody>
        @{
            var i = 0;
        }
        @if (ViewBag.AvailableModel == null || ViewBag.AvailableModel.Count == 0)
        {
            <tr>
                <td colspan="8" class="text-center">No matching data found.</td>
            </tr>
        }
        else
        {
            @foreach (var item in ViewBag.AvailableModel)
            {
                string[] emailArr = splitEmail(@item.lawyer.email);
                string[] phoneArr = splitPhone(@item.lawyer.phone);
                <tr>
                    <td>@(i + 1)</td>
                    <td>@item.lawyer.name</td>
                    <td>@item.lawyer.sureName</td>
                    <td>@(emailArr.Length > 0 ? emailArr[0] : "")</td>
                    <td>@(phoneArr.Length > 0 ? @phoneArr[0].Replace("Tel.", "") : "")</td>
                    <td>@(phoneArr.Length > 1 ? @phoneArr[1].Replace("Tel.", "") : "")</td>
                    <td>@(emailArr.Length > 1 ? emailArr[1] : "")</td>
                    <td>Please do not send me requests after 8:00 pm</td>
                </tr>
                i++;
            }
        }
    </tbody>
</table>
<script>
    function submitForm() {
        $("#searchform").submit();
    }
</script>
@{
    string[] splitEmail(string origin_email)
    {
        string temp = origin_email.Replace("[", "").Replace("]", "").Replace(" ", "").Replace("\"", "");
        string[] result = temp.Split(',');
        return result;
    }

    string[] splitPhone(string origin_phone)
    {
        string temp = origin_phone.Replace("[", "").Replace("]", "").Replace(" ", "").Replace("\"", "");
        string[] result = temp.Split(',');
        return result;
    }
}